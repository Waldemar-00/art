{"version":3,"sources":["js/modules/forms.js"],"names":["formsFn","forms","document","querySelectorAll","inputs","uploads","messege","loading","success","failure","spinner","ok","failureImg","clearInputs","forEach","input","value","load","previousElementSibling","innerText","urls","postText","postImg","postData","url","data","dataObject","key","response","fetch","method","headers","body","JSON","stringify","text","addEventListener","dots","array","files","name","split","length","nameImg","substring","form","e","preventDefault","messegeBox","createElement","classList","add","parentElement","append","setTimeout","style","display","showImg","src","textMessege","formData","FormData","api","closest","contains","console","log","then","setAttribute","textContent","catch","finally","remove","overflow"],"mappings":"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","file":"forms.63ba114c.js","sourceRoot":"..\\src","sourcesContent":["\r\n// const checkNum = (selector) => {\r\n    // const inputs = document.querySelectorAll(selector);\r\n    // inputs.forEach((input) => {\r\n        // input.addEventListener('input', () => {\r\n            // input.value = input.value.replace(/\\D/, '');\r\n        // });\r\n    // });\r\n// };\r\n\r\nconst formsFn = () => {\r\n    const forms = document.querySelectorAll('form');\r\n    const inputs = document.querySelectorAll('input');\r\n    const uploads = document.querySelectorAll('[name=\"upload\"]');\r\n    //checkNum('input[name=\"user_phone\"]');\r\n    const messege = {\r\n        loading: \"Загрузка ваших данных\",\r\n        success: \"Спасибо, мы скоро с Вами свяжемся!\",\r\n        failure: \"Что-то сломалось :(\",\r\n        spinner: 'assets/img/spinner.gif',\r\n        ok: 'assets/img/ok.png',\r\n        failureImg: 'assets/img/fail.png',\r\n    };\r\n    const clearInputs = () => {\r\n        inputs.forEach(input => input.value = '');\r\n        uploads.forEach(load => load.previousElementSibling.innerText = 'Файл не выбран');\r\n    };\r\n    const urls = {\r\n        postText: 'https://jsonplaceholder.typicode.com/users',\r\n        postImg: 'https://jsonplaceholder.typicode.com/photos'\r\n    };\r\n    const postData = async (url, data) => {\r\n        const dataObject = {};\r\n        data.forEach((value, key) => {\r\n            dataObject[key] = value;\r\n        });\r\n        const response = await fetch(url , {\r\n            method: 'POST',\r\n            headers: {\r\n                \"Content-type\": \"application/json;charset=UTF-8\",\r\n            },\r\n            body: JSON.stringify(dataObject),\r\n        });\r\n        return await response.text();\r\n    };\r\n    uploads.forEach(load => {\r\n        load.addEventListener('input', () => {\r\n            let dots;\r\n            const array = load.files[0].name.split('.');\r\n            array[0].length > 6 ? dots = '...' : dots = '.';\r\n            const nameImg = array[0].substring(0, 6) +\r\n                dots + array[1];\r\n            load.previousElementSibling.innerText = nameImg;\r\n        });\r\n    });\r\n    forms.forEach((form) => {\r\n        form.addEventListener('submit', (e) => {\r\n            e.preventDefault();\r\n\r\n            const messegeBox = document.createElement('div');\r\n            form.classList.add('animated', 'fadeOutUp');\r\n            messegeBox.classList.add('status');\r\n            form.parentElement.append(messegeBox);\r\n            setTimeout(() => { \r\n                form.style.display = 'none';\r\n            }, 400);\r\n            const showImg = document.createElement('img');\r\n            showImg.src = messege.spinner;\r\n            //showImg.setAttribute('src', messege.spinner);\r\n            showImg.classList.add('animated', 'fadeInUp');\r\n            messegeBox.append(showImg);   \r\n            const textMessege = document.createElement('div');\r\n            textMessege.innerText = messege.loading;\r\n            messegeBox.append(textMessege);\r\n\r\n            const formData = new FormData(form);\r\n            let api;\r\n            form.closest('.popup-design') || form.classList.contains('calc_form') ?\r\n                api = urls.postImg : api = urls.postText;\r\n            console.log(api);\r\n            postData(api, formData)\r\n                .then(response => {\r\n                    console.log(response);\r\n                    showImg.setAttribute('src', messege.ok);\r\n                    textMessege.textContent = messege.success;\r\n            })\r\n                .catch(() => {\r\n                    showImg.setAttribute('src', messege.failureImg);\r\n                    textMessege.textContent = messege.failure;\r\n                })\r\n                .finally(() => {\r\n                    clearInputs();\r\n                    setTimeout(() => {\r\n                        messegeBox.remove();\r\n                        form.style.display = 'block';\r\n                        form.classList.remove('fadeOutUp');\r\n                        form.classList.add('fadeInUp');\r\n                        document.body.style.overflow = 'visible';\r\n                    }, 4000);\r\n                });\r\n        });\r\n    });\r\n};\r\nexport default formsFn;"]}